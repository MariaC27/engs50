https://thayer.github.io/engs50/Notes/indexer/
2
9111
<!DOCTYPEhtml><html><head><metacharset="utf-8"><metahttp-equiv="X-UA-Compatible"content="IE=edge"><metaname="viewport"content="width=device-width,initial-scale=1"><title>TSEIndexer</title><metaname="description"content="InEngs50youwilllearnhowtodesign&buildlarge,reliable,maintainable,andunderstandablesoftwaresystems.IntheprocessyouwilllearntoprograminCwithUnixdevelopmenttools."><linkrel="shortcuticon"href="/engs50/50.png"/><linkrel="stylesheet"href="/engs50/css/main.css"><linkrel="canonical"href="/engs50/Notes/indexer/"></head><body><headerclass="site-header"><aclass="site-title"href="/engs50/"><imgwidth=48align=centersrc="/engs50/50.png"alt="icon">Engs50(CS50)</a><navclass="site-nav">[<ahref="/engs50/Labs/">Labs</a>][<ahref="/engs50/Notes/">Notes</a>][<ahref="/engs50/Reading/">Reading</a>][<ahref="/engs50/Resources/">Resources</a>][<ahref="/engs50/Examples/">Examples</a>]</nav></header><divclass="page-content"><divclass="wrapper"><articleclass="post"><headerclass="post-header"><h1class="post-title">TSEIndexer</h1></header><divclass="post-content"><h3id="goals">Goals</h3><ul><li>toreflectonourdesignprinciplesandtheCrawler</li><li>toreviewthespecsfortheIndexer</li><li>toexplorethedesignofdatastructuresforasearch-engineindex</li></ul><h2id="key-points-in-the-crawler-design">KeypointsintheCrawlerdesign</h2><p>Whataresomeofthekeyideasinthecrawlerdesign?</p><p>First,we<strong><em>separateapplication-specificlogicfromgeneral-purposeutilitymodules.</em></strong>Byleveraginggeneral-purposemodulesfromLab3,codingthecrawler-specficlogicismuchcleanerandsimplerthanifitwerewoveninwiththedata-structurecode.</p><blockquote><p>Ifyourcrawlerweavesthelogicofwebcrawlingintothedetailsofanyofyourdatastructures,you’vemissedthisopportunity-yourcodeislikelymorecomplicated,morebuggy,hardertodebug,hardertotest,hardertomaintain,andmuchhardertoreuseandextend.</p></blockquote><p>Second,wenote<strong><em>gooddata-structuredesigniskeytosuccessfulprojects.</em></strong></p><p>Thedesignofthecrawlerremainssimplebecausewechosetwodatastructures-a<em>bag</em>forthesetofpagesyettocrawl,anda<em>hashtable</em>forthesetofURLsalreadyseen-thatsupporttheoverallcontrolflow.</p><p>Ontheotherhand,whenwegettotheindexerandquerierwemayfindthatweneedtoadjustthecodetoprovideslightlydifferentfunctionality,ortofactoroutcodethatneedstobeusedbymultiplecomponents.It’shardtohaveperfectforesight.</p><p><ahref="http://pragprog.com/the-pragmatic-programmer/extracts/tips">PragmaticProgrammerTip</a>:</p><blockquote><p><strong>Therearenofinaldecisions</strong>Nodecisioniscastinstone.Instead,considereachasbeingwritteninthesandatthebeach,andplanforchange.</p></blockquote><p>Notallofthedesigndecisionswemadeatthebeginningofcrawlermadeitthroughtheimplementationandtestingtothefinalcode.Manytimesyou’llsay“itsoundedlikeagoodidea(design)atthetime.”Thesoftwaredevelopmentprocessispreciselythat:aprocess.Itisnotaprogrammeronaone-waystreet,butmorelikeachefcraftinganewdish.Youhaveaplanthateveryoneagreeson,youbegintoexecuteonthatplan,andsometimesconditionschangeandunexpectedinteractionsarise.Youhavetohandlethemandandstillgettothegoal.</p><p>Finally,manyofyouhavefoundthat<strong><em>shellscriptscanautomatetesting.</em></strong>It’sfareasiertotestyourcrawlerbywritingabashscripttodrivevarioustestcases,ortoexaminetheoutputforcorrectness,thantomanuallyrunavarietyoftestsforeachnewversionofthecode.Evenbetter,now’sthetimetouseyour<codeclass="language-plaintexthighlighter-rouge">regress.sh</code>scriptfrom<ahref="/engs50/Labs/Lab2">Lab2</a>.</p><blockquote><p><strong>“UsetheShell,Luke”</strong>.Knowanduseyourtools.</p></blockquote><h2id="on-to-the-indexer">OntotheIndexer!</h2><p>Thejobofthe<codeclass="language-plaintexthighlighter-rouge">indexer</code>istoreadthedocumentsinthe<codeclass="language-plaintexthighlighter-rouge">pageDirectory</code>outputbythe<codeclass="language-plaintexthighlighter-rouge">crawler</code>,buildaninvertedindexmappingfromwordstodocuments,andwritethatindextoafile.(Later,the<codeclass="language-plaintexthighlighter-rouge">querier</code>willreadtheindexanduseittoanswerqueries.)</p><p>NowisagoodtimetoreadSection4in<em><ahref="/engs50/Reading/searchingtheweb.pdf">SearchingtheWeb</a></em>,thepaperaboutsearchengines.</p><p>Today’sTerminal<ahref="/engs50/Notes/indexer/script1.txt">script</a>showssomeofmyclassroomdemos;itliststhefilesandstructureofacompleteandcleanTSEdirectory.AnotherTerminal<ahref="/engs50/Notes/indexer/script2.txt">script</a>isarecreationofan<codeclass="language-plaintexthighlighter-rouge">indexer</code>demoIraninclass;itshowshowan<codeclass="language-plaintexthighlighter-rouge">indextest.sh</code>mightlook.</p><h3id="indexer-requirements">Indexerrequirements</h3><p>Seethe<ahref="/engs50/Labs/Lab5/REQUIREMENTS.html">Requirementsspec</a>.</p><h3id="activity">Activity</h3><p>Intoday’s<ahref="activity.html">activity</a>yourgroupwilldiscussideasfortheindexerdesign.</p><!--Hidetherestofthispageuntilactivityperiodisover.--><h3id="indexer-design">Indexerdesign</h3><p>You’llbewritingouttheDesignSpecsaspartofLab5.Tohelpyougetstarted,inthislecturewesketchoutthekeydatastructureandsomehigh-levelpseudocode.</p><h4id="data-structure-inverted-index">Datastructure:Invertedindex</h4><p>Weneedadatastructuretorepresenttheinvertedindex.It’scalledan<em>inverted</em>indexbecauseitmapsfromwordstodocuments,theoppositeofadocument(itselfasequenceofwords).</p><p>Ahashtableisagreatstart,becausewecanlookupawordinahashtableinO(1)time.Butwhatisinthehashtable?Foreachword,weneedalistofdocuments.(Notthedocumentsthemselves,silly,justthedocumentIDs.)Actually,toenableustolater<em>rank</em>thematches,we’dalsoliketorecordhowmanytimesthegivenwordappearsineachdocument.</p><p>Considerthedatastructureswehavehandy:hashtable,set,bag,andcounters.(Oh,andtree.)A<em>hashtableofcountersets</em>isperfecttomapfromawordtoalistof(docID,count)pairs.Seethediagrambelow:</p><p><imgsrc="/engs50/Notes/indexer/data-model.png"alt="Indexerdataflow"/></p><p>Wegettousethreeoutofourfourdatastructures:hashtable,set,andcounters!</p><p>Whenprocessingagivendocument(identifiedbydocID),considereachword;lookupthatwordinthehashtableandretrieveapointertoa<codeclass="language-plaintexthighlighter-rouge">counters_t*</code>item;thenuse<codeclass="language-plaintexthighlighter-rouge">counters_add()</code>onthatitem,usingthedocIDasakey.</p><p>Yourdata-setiterators(like<codeclass="language-plaintexthighlighter-rouge">hashtable_iterate()</code>)shouldbeveryusefulforsavinganindextoafile,orforlaterloadinganindexfromafile.</p><h4id="indexer-pseudocode">Indexerpseudocode</h4><p>Veryhigh-leveldescriptionoftheindexerandindextest.</p><p><codeclass="language-plaintexthighlighter-rouge">indexer</code>:</p><ol><li>Processandvalidatecommand-lineparameters</li><li>Initializedatastructure<em>index</em></li><li>index_build(directory,<em>index</em>)</li><li>index_save(file,<em>index</em>);</li><li>cleanupdatastructures</li></ol><p><codeclass="language-plaintexthighlighter-rouge">indextest</code>:</p><ol><li>Processandvalidatecommand-lineparameters</li><li>Initializedatastructure<em>index</em></li><li>index_load(file1,<em>index</em>)</li><li>index_save(file2,<em>index</em>)</li><li>cleanupdatastructures</li></ol></div></article></div></div><footerclass="site-footer"><divclass="wrapper"><h2class="footer-heading">Engs50(CS50)--DartmouthCollege</h2><p><fontsize=-1>ThisversionofthecourseisbaseduponthosedesignedbyProfessorsPalmer,Kotz,Zhou,Campbell,andBalkcom.Iamdeeplyindebtedtotheseoutstandingeducators.--<ahref="https://engineering.dartmouth.edu/people/faculty/stephen-taylor/">StephenTaylor</a></font></p><p><small>Thispagewaslastupdatedon<strong>2023-01-05</strong>at<strong>11:31</strong>.</small></p></div></footer></body></html>
