https://thayer.github.io/engs50/Notes/design/activity.html
3
6245
<!DOCTYPEhtml><html><head><metacharset="utf-8"><metahttp-equiv="X-UA-Compatible"content="IE=edge"><metaname="viewport"content="width=device-width,initial-scale=1"><title>Activity-Cpreprocessor</title><metaname="description"content="InEngs50youwilllearnhowtodesign&buildlarge,reliable,maintainable,andunderstandablesoftwaresystems.IntheprocessyouwilllearntoprograminCwithUnixdevelopmenttools."><linkrel="shortcuticon"href="/engs50/50.png"/><linkrel="stylesheet"href="/engs50/css/main.css"><linkrel="canonical"href="/engs50/Notes/design/activity.html"></head><body><headerclass="site-header"><aclass="site-title"href="/engs50/"><imgwidth=48align=centersrc="/engs50/50.png"alt="icon">Engs50(CS50)</a><navclass="site-nav">[<ahref="/engs50/Labs/">Labs</a>][<ahref="/engs50/Notes/">Notes</a>][<ahref="/engs50/Reading/">Reading</a>][<ahref="/engs50/Resources/">Resources</a>][<ahref="/engs50/Examples/">Examples</a>]</nav></header><divclass="page-content"><divclass="wrapper"><articleclass="post"><headerclass="post-header"><h1class="post-title">Activity-Cpreprocessor</h1></header><divclass="post-content"><h3id="goals">Goals</h3><ul><li>tousetheCpreprocessor</li><li>tounderstandwhenlinkermightproduceerrors.</li></ul><h2id="activity">Activity</h2><p>Examinethesourcefilesin<ahref="/engs50/Examples/seuss">~cs50/examples/seuss</a>,shownbelow.</p><ol><li>Trytocompiletheprogram.Whydoyougetanerror?isitthecompilerorlinkerreportingtheerror?whatcouldyoudotofixit?</li><li>Run<codeclass="language-plaintexthighlighter-rouge">gcc-Eseuss.c</code>,whichrunsthe<em>Cpreprocessor</em>only;thisoutputiswhatthecompilerwouldconsume.Lookattheoutput;ignorethe<codeclass="language-plaintexthighlighter-rouge">#</code>lines,whichareannotationstohelpthecompilerproduceerrormessagesthatreferencetheoriginalfilenameandlinenumber.Noticehowthepreprocessorhascopiedeverythingfromtheincludefilesrightintotheinput,atthepointwheretheyareincludedin<codeclass="language-plaintexthighlighter-rouge">seuss.c</code>,andthenstrippedoutallthecomments.</li><li>Afterclass,re-readthe<ahref="/makefiles/preprocessor.html">LectureextraabouttheCpreprocessor</a>.</li></ol><divclass="language-chighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="cm">/*seuss.c-usesthingoneandthingtwo.*/</span><spanclass="cp">#include"one.h"#include"two.h"</span><spanclass="kt">int</span><spanclass="nf">main</span><spanclass="p">()</span><spanclass="p">{</span><spanclass="kt">int</span><spanclass="n">fun</span><spanclass="o">=</span><spanclass="n">thing_one</span><spanclass="p">()</span><spanclass="o">+</span><spanclass="n">thing_two</span><spanclass="p">();</span><spanclass="k">return</span><spanclass="n">fun</span><spanclass="p">;</span><spanclass="c1">//exitstatus</span><spanclass="p">}</span></code></pre></div></div><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>/*one.h*/intone=1;externintthing_one(void);</code></pre></div></div><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>/*two.h*/inttwo=2;externintthing_two(void);</code></pre></div></div><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>/*one.c*/#include"one.h"intthing_one(void){returnone;}</code></pre></div></div><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>/*two.c*/#include"two.h"intthing_two(void){returntwo;}</code></pre></div></div><!--##SolutionWhenyoucompiletheprogram:```bash[cs50@flume~/demo/seuss1]$mygcc-cone.c[cs50@flume~/demo/seuss1]$mygcc-ctwo.c[cs50@flume~/demo/seuss1]$mygcc-cseuss.c[cs50@flume~/demo/seuss1]$mygccseuss.oone.otwo.o-oseussone.o:(.data+0x0):multipledefinitionof`one'seuss.o:(.data+0x0):firstdefinedheretwo.o:(.data+0x0):multipledefinitionof`two'seuss.o:/net/class/cs50/demo/seuss1/seuss.c:7:firstdefinedherecollect2:error:ldreturned1exitstatus```Thelinker`ld`complainsbecausetheglobalvariables`one`and`two`aremultiplydefined.Thishappensbecausethevariablesaredefined(notjustdeclared)intherespective`.h`files,andthose`.h`filesareincludedintherespective`.c`files*and*in`seuss.c`.Thesolutionistomovethoseglobalvariablesoutofthe`.h`fileintotherespective`.c`files.Theyareonlyusedinthosefiles,anyway,sotheyshouldfurtherbemarked`static`(sotheyareinvisibleoutsidethefileinwhichtheyaredefined).Thus,```c/*seuss.c-usesthingoneandthingtwo.*/#include"one.h"#include"two.h"intmain(){intfun=thing_one()+thing_two();returnfun;//exitstatus}``````/*one.h*/externintthing_one(void);``````/*two.h*/externintthing_two(void);``````/*one.c*/#include"one.h"staticintone=1;//thislinemovedandmadestaticintthing_one(void){returnone;}``````/*two.c*/#include"two.h"staticinttwo=2;//thislinemovedandmadestaticintthing_two(void){returntwo;}```--></div></article></div></div><footerclass="site-footer"><divclass="wrapper"><h2class="footer-heading">Engs50(CS50)--DartmouthCollege</h2><p><fontsize=-1>ThisversionofthecourseisbaseduponthosedesignedbyProfessorsPalmer,Kotz,Zhou,Campbell,andBalkcom.Iamdeeplyindebtedtotheseoutstandingeducators.--<ahref="https://engineering.dartmouth.edu/people/faculty/stephen-taylor/">StephenTaylor</a></font></p><p><small>Thispagewaslastupdatedon<strong>2023-01-05</strong>at<strong>11:31</strong>.</small></p></div></footer></body></html>
