https://thayer.github.io/engs50/Notes/unittest/activity.html
3
7445
<!DOCTYPEhtml><html><head><metacharset="utf-8"><metahttp-equiv="X-UA-Compatible"content="IE=edge"><metaname="viewport"content="width=device-width,initial-scale=1"><title>Activity-Unittesting</title><metaname="description"content="InEngs50youwilllearnhowtodesign&buildlarge,reliable,maintainable,andunderstandablesoftwaresystems.IntheprocessyouwilllearntoprograminCwithUnixdevelopmenttools."><linkrel="shortcuticon"href="/engs50/50.png"/><linkrel="stylesheet"href="/engs50/css/main.css"><linkrel="canonical"href="/engs50/Notes/unittest/activity.html"></head><body><headerclass="site-header"><aclass="site-title"href="/engs50/"><imgwidth=48align=centersrc="/engs50/50.png"alt="icon">Engs50(CS50)</a><navclass="site-nav">[<ahref="/engs50/Labs/">Labs</a>][<ahref="/engs50/Notes/">Notes</a>][<ahref="/engs50/Reading/">Reading</a>][<ahref="/engs50/Resources/">Resources</a>][<ahref="/engs50/Examples/">Examples</a>]</nav></header><divclass="page-content"><divclass="wrapper"><articleclass="post"><headerclass="post-header"><h1class="post-title">Activity-Unittesting</h1></header><divclass="post-content"><p>Considerthesimpleone-function<codeclass="language-plaintexthighlighter-rouge">jhash</code>moduleusedinLab3andtheTSE.Itcomprises<ahref="/engs50/Labs/Lab3/starter/hashtable/jhash.c">jhash.c</a>and<ahref="/engs50/Labs/Lab3/starter/hashtable/jhash.h">jhash.h</a>andimplementsthe<codeclass="language-plaintexthighlighter-rouge">JenkinsHash()</code>functionbelow.</p><ol><li>Withyourgroup,listallthetestsagoodunittestshouldrunagainstthisunit.<ul><li>Canyouspotthebug?(IjustnoticedoneIâ€™doverlookedbefore.)</li><li>Ifyouhavetime,</li></ul><ul><li>downloadtheabovefiles,orcopythem:</li><li><codeclass="language-plaintexthighlighter-rouge">cp~cs50/public_html/Labs/Lab3/starter/hashtable/jhash.[ch].</code></li><li>extend<codeclass="language-plaintexthighlighter-rouge">jhash.c</code>withaunittestlikethosewesawdemonstratedinclasstoday;youcan<codeclass="language-plaintexthighlighter-rouge">#include"unittest.h"</code>andcopythatfilefrom<codeclass="language-plaintexthighlighter-rouge">~cs50/examples/unittest.h</code>foryourtesting.</li></ul></li></ol><divclass="language-chighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="kt">unsigned</span><spanclass="kt">long</span><spanclass="nf">JenkinsHash</span><spanclass="p">(</span><spanclass="k">const</span><spanclass="kt">char</span><spanclass="o">*</span><spanclass="n">str</span><spanclass="p">,</span><spanclass="kt">unsigned</span><spanclass="kt">long</span><spanclass="n">mod</span><spanclass="p">)</span><spanclass="p">{</span><spanclass="k">if</span><spanclass="p">(</span><spanclass="n">str</span><spanclass="o">==</span><spanclass="nb">NULL</span><spanclass="p">)</span><spanclass="k">return</span><spanclass="mi">0</span><spanclass="p">;</span><spanclass="kt">size_t</span><spanclass="n">len</span><spanclass="o">=</span><spanclass="n">strlen</span><spanclass="p">(</span><spanclass="n">str</span><spanclass="p">);</span><spanclass="kt">unsigned</span><spanclass="kt">long</span><spanclass="n">hash</span><spanclass="p">,</span><spanclass="n">i</span><spanclass="p">;</span><spanclass="k">for</span><spanclass="p">(</span><spanclass="n">hash</span><spanclass="o">=</span><spanclass="n">i</span><spanclass="o">=</span><spanclass="mi">0</span><spanclass="p">;</span><spanclass="n">i</span><spanclass="o">&lt;</span><spanclass="n">len</span><spanclass="p">;</span><spanclass="o">++</span><spanclass="n">i</span><spanclass="p">)</span><spanclass="p">{</span><spanclass="n">hash</span><spanclass="o">+=</span><spanclass="n">str</span><spanclass="p">[</span><spanclass="n">i</span><spanclass="p">];</span><spanclass="n">hash</span><spanclass="o">+=</span><spanclass="p">(</span><spanclass="n">hash</span><spanclass="o">&lt;&lt;</span><spanclass="mi">10</span><spanclass="p">);</span><spanclass="n">hash</span><spanclass="o">^=</span><spanclass="p">(</span><spanclass="n">hash</span><spanclass="o">&gt;&gt;</span><spanclass="mi">6</span><spanclass="p">);</span><spanclass="p">}</span><spanclass="n">hash</span><spanclass="o">+=</span><spanclass="p">(</span><spanclass="n">hash</span><spanclass="o">&lt;&lt;</span><spanclass="mi">3</span><spanclass="p">);</span><spanclass="n">hash</span><spanclass="o">^=</span><spanclass="p">(</span><spanclass="n">hash</span><spanclass="o">&gt;&gt;</span><spanclass="mi">11</span><spanclass="p">);</span><spanclass="n">hash</span><spanclass="o">+=</span><spanclass="p">(</span><spanclass="n">hash</span><spanclass="o">&lt;&lt;</span><spanclass="mi">15</span><spanclass="p">);</span><spanclass="k">return</span><spanclass="n">hash</span><spanclass="o">%</span><spanclass="n">mod</span><spanclass="p">;</span><spanclass="p">}</span></code></pre></div></div><!--##SolutionThebugisactuallyafailuretobedefensiveinregardstothearguments.Ifacallerpasses`mod=0`thenthisfunctionwilldividebyzeroandtheprogramwillcrash.Thecallercannotpassanegative`mod`--becausetheparameterisof`unsigned`type.(It'sworthconsideringwhether`mod=1`shouldbeallowed--with`mod=1`thehashwouldalwaysbezero.)Youcouldcreatesomeunittestsbyaddingthefollowingtothebottomof`jhash.c`:```c#ifdefUNIT_TEST#include<stdio.h>#include"unittest.h"intmain(){START_TEST_CASE("jhash");EXPECT(JenkinsHash(NULL,1)==0);EXPECT(JenkinsHash("",1)==0);EXPECT(JenkinsHash("CS50",1)==0);EXPECT(JenkinsHash("CS50",99999)==JenkinsHash("CS50",99999));EXPECT(JenkinsHash("CS50",99999)==18704);EXPECT(JenkinsHash("Thisisaverylongstringanditwillmakeithardtoreadthistest;fortunately,thefunctiondoesnotcare.",99999)==86041);END_TEST_CASE;returnTEST_RESULT;}#endif//UNIT_TEST```Ididnottestthe`mod=0`casebecauseIdon'twanttocrashtheprogram.IfIfixthatbugbychangingthefirstlinesofthefunction:```cif(str==NULL||mod<=1)return0;```Icouldthenaddanothertestcase.```cEXPECT(JenkinsHash("CS50",0)==0);```Here'sthefinal[jhash.c](/engs50/Notes/unittest/jhash.c).--></div></article></div></div><footerclass="site-footer"><divclass="wrapper"><h2class="footer-heading">Engs50(CS50)--DartmouthCollege</h2><p><fontsize=-1>ThisversionofthecourseisbaseduponthosedesignedbyProfessorsPalmer,Kotz,Zhou,Campbell,andBalkcom.Iamdeeplyindebtedtotheseoutstandingeducators.--<ahref="https://engineering.dartmouth.edu/people/faculty/stephen-taylor/">StephenTaylor</a></font></p><p><small>Thispagewaslastupdatedon<strong>2023-01-05</strong>at<strong>11:31</strong>.</small></p></div></footer></body></html>
