https://thayer.github.io/engs50/Notes/bash2/
2
41536
<!DOCTYPEhtml><html><head><metacharset="utf-8"><metahttp-equiv="X-UA-Compatible"content="IE=edge"><metaname="viewport"content="width=device-width,initial-scale=1"><title>MoreaboutBash</title><metaname="description"content="InEngs50youwilllearnhowtodesign&buildlarge,reliable,maintainable,andunderstandablesoftwaresystems.IntheprocessyouwilllearntoprograminCwithUnixdevelopmenttools."><linkrel="shortcuticon"href="/engs50/50.png"/><linkrel="stylesheet"href="/engs50/css/main.css"><linkrel="canonical"href="/engs50/Notes/bash2/"></head><body><headerclass="site-header"><aclass="site-title"href="/engs50/"><imgwidth=48align=centersrc="/engs50/50.png"alt="icon">Engs50(CS50)</a><navclass="site-nav">[<ahref="/engs50/Labs/">Labs</a>][<ahref="/engs50/Notes/">Notes</a>][<ahref="/engs50/Reading/">Reading</a>][<ahref="/engs50/Resources/">Resources</a>][<ahref="/engs50/Examples/">Examples</a>]</nav></header><divclass="page-content"><divclass="wrapper"><articleclass="post"><headerclass="post-header"><h1class="post-title">MoreaboutBash</h1></header><divclass="post-content"><p>Don’tforgetthisweek’s<ahref="/engs50/Reading/#week-1">reading</a>.</p><p>Inthislecture,wecontinueourdiscussionoftheUnixshellanditscommands.</p><h2id="goals">Goals</h2><p>Weplantolearnthefollowingtoday:</p><ul><li>Redirectionandpipes</li><li>Specialcharactersandquoting</li><li>Standardinput,output,anderror</li></ul><p>We’lldothisactivityintoday’sclass:</p><ul><li>Sitwithyourgroup,andgettoknowyourgroupmates.</li><li>Experimentwithshellpipelinesinthis<ahref="activity.html">Activity</a>.</li></ul><h3id="class-scripts">Classscripts</h3><p>IrecordedmyTerminalwindowsfrom<ahref="/engs50/Notes/bash2/script-flume.txt">flume</a>and<ahref="/engs50/Notes/bash2/script-mac.txt">Mac</a>.</p><h2id="redirection-and-pipes">Redirectionandpipes</h2><p>TodatewehaveseenUnixprogramsusingdefaultinputandoutput-called<em>standardinput</em>(stdin)and<em>standardoutput</em>(stdout)-thekeyboardisthestandardinputandthedisplaythestandardoutput.TheUnixshellisabletoredirectboththeinputandoutputofprograms.Asanexampleofoutputredirectionconsiderthefollowing.</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">date</span><spanclass="o">&gt;</span>listing<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">ls</span><spanclass="nt">-lR</span>public_html/<spanclass="o">&gt;&gt;</span>listing</code></pre></div></div><p>Theoutputredirection<codeclass="language-plaintexthighlighter-rouge">&gt;</code>writestheoutputof<codeclass="language-plaintexthighlighter-rouge">date</code>tothefilecalled<codeclass="language-plaintexthighlighter-rouge">listing</code>;thatis,the‘standardoutput’ofthe<codeclass="language-plaintexthighlighter-rouge">date</code>processhasbeendirectedtothefileinsteadofthedefault,thedisplay.Notethatthe<codeclass="language-plaintexthighlighter-rouge">&gt;</code>operationcreatedafilethatdidnotexistbeforetheoutputredirectioncommandwasexecuted.Next,weappendarecursive,long-formatdirectorylistingtothesamefile;byusingthe<codeclass="language-plaintexthighlighter-rouge">&gt;&gt;</code>(double<codeclass="language-plaintexthighlighter-rouge">&gt;</code>)wetelltheshellto<em>append</em>tothefileratherthanoverwritingthefile.</p><p>Notethatthe<codeclass="language-plaintexthighlighter-rouge">&gt;</code>or<codeclass="language-plaintexthighlighter-rouge">&gt;&gt;</code>andtheirtargetfilenamesare<em>not</em>argumentstothecommand-thecommandsimplywritestostdout,asitalwaysdoes,buttheshellhasarrangedforstdouttobedirectedtoafileinsteadoftheterminal.</p><p>Theshellalsosupportsinputredirection.Thisprovidesinputtoaprogram(ratherthanthekeyboard).Let’screateafileofprimenumbersusingoutputredirection.Theinputtothe<codeclass="language-plaintexthighlighter-rouge">cat</code>commandcancomefromthestandardinput(i.e.,thekeyboard).Wecaninstructtheshelltoredirectthe<codeclass="language-plaintexthighlighter-rouge">cat</code>command’soutput(stdout)tofilenamed<codeclass="language-plaintexthighlighter-rouge">primes</code>.Thenumbersareinputatthekeyboardand<codeclass="language-plaintexthighlighter-rouge">CTRL-D</code>isusedtosignaltheendofthefile(<codeclass="language-plaintexthighlighter-rouge">EOF</code>).</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cat</span><spanclass="o">&gt;</span>primes6153412311131837519232931475359<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>Inputredirection<codeclass="language-plaintexthighlighter-rouge">&lt;</code>tellstheshelltouseafileasinputtothecommandratherthanthekeyboard.Intheinputredirectionexamplebelow<codeclass="language-plaintexthighlighter-rouge">primes</code>isusedasinputto<codeclass="language-plaintexthighlighter-rouge">cat</code>whichsendsitsstandardoutputtothescreen.</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cat</span>&lt;primes6153412311131837519232931475359<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>ManyUnixcommands(e.g.,<codeclass="language-plaintexthighlighter-rouge">cat</code>,<codeclass="language-plaintexthighlighter-rouge">sort</code>)allowyoutoprovideinputfromstdinifyoudonotspecifyafileonthecommandline.Forexample,ifyoutype<codeclass="language-plaintexthighlighter-rouge">cat(CR)</code>(carriagereturn)thenthecommandexpectsinputfromthestandardinput.</p><p>Unixalsosupportsapowerful‘pipe’operatorforpassingdatabetweencommandsusingtheoperator<codeclass="language-plaintexthighlighter-rouge">|</code>(averticalbar,usuallylocatedabovethe<codeclass="language-plaintexthighlighter-rouge">\</code>keyonyourkeyboard).Pipesconnectcommandsthatrunasseparateprocessesasdatabecomesavailabletheprocessesarescheduled.</p><blockquote><p>PipeswereinventedbyDougMcIlroywhilehewasworkingwithKenThompsonandDennisRitchieatAT&amp;TBellLabs.(AsImentionedearlier,DoughasbeenanadjunctprofessorhereatDartmouthCollegeforseveralyearsnow.)Inthis<ahref="/engs50/Reading/DougMcIlroy.pdf">two-pageinterview</a>,atthemiddleofthethirdcolumn,Dougtellshowpipeswereinventedandthe<codeclass="language-plaintexthighlighter-rouge">|</code>characterselectedastheoperator.Payspecialattentiontothenextparagraph:theDartmouthTimeSharingSystemhadsomethingsimilar,evenearlier!</p></blockquote><p>Pipesareacleverinventionindeed,sincetheneedforseparatetemporaryfilesforsharingdatabetweenprocessesisnotrequired.Becausecommandsareimplementedasprocesses,aprogramreadinganemptypipewillbe``suspended’’untilthereisdataorinformationreadyforittoread.Thereisnolimittothenumberofprogramsorcommandsinthepipeline.Inourexamplebelowtherearefourprogramsinthepipelineallrunningsimultaneouslywaitingontheinput:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">sort</span><spanclass="nt">-n</span>primes|<spanclass="nb">uniq</span>|<spanclass="nb">grep</span><spanclass="nt">-v</span>18|more235111319232931374147535961<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>Whatisthedifferencebetweenpipesandredirection?Basically,redirection(<codeclass="language-plaintexthighlighter-rouge">&gt;</code>,<codeclass="language-plaintexthighlighter-rouge">&gt;&gt;</code>,<codeclass="language-plaintexthighlighter-rouge">&lt;</code>)isusedtodirectthestdoutofcommandtoafile,orfromafiletothestdinofacommand.Pipes(<codeclass="language-plaintexthighlighter-rouge">|</code>)areusedtoredirectthestdouttothestdinofanothercommand.Thisoperatorallowsusto‘glue’togetherprogramsas‘filters’toprocesstheplaintextsentbetweenthem(<em>plaintext</em>betweentheprocesses-anicedesigndecision).Thissupportsthenotionofreuseandallowsustobuildsophisticatedprogramsquicklyandsimply.It’sanothercoolfeatureofUnix.</p><p>Noticethreenewcommandsabove:<codeclass="language-plaintexthighlighter-rouge">sort</code>,<codeclass="language-plaintexthighlighter-rouge">uniq</code>,and<codeclass="language-plaintexthighlighter-rouge">grep</code>.</p><ul><li><codeclass="language-plaintexthighlighter-rouge">sort</code>readslinesfromfromstdinandoutputsthelinesinsortedorder;here<codeclass="language-plaintexthighlighter-rouge">-n</code>tells`sorttousenumericorder(ratherthanalphabeticalorder);</li><li><codeclass="language-plaintexthighlighter-rouge">uniq</code>removesduplicates,printingonlyoneofarunofidenticallines;</li><li><codeclass="language-plaintexthighlighter-rouge">grep</code>printslinesmatchingapattern(moregenerally,a<em>regularexpression</em>);here,<codeclass="language-plaintexthighlighter-rouge">-v</code>invertsthisbehavior:printlinesthat<em>donot</em>matchthepattern.Inthiscase,thepatternissimply<codeclass="language-plaintexthighlighter-rouge">18</code>and<codeclass="language-plaintexthighlighter-rouge">grep</code>doesnotprintthatnumberasitcomesthrough.</li></ul><p>And,aswesawlasttime,<codeclass="language-plaintexthighlighter-rouge">more</code>pausestheoutputwhenitwouldscrolloffthescreen.</p><p>Notethattheoriginalfile-<codeclass="language-plaintexthighlighter-rouge">primes</code>-isnotchangedbyexecutingthecommandlineabove.Rather,thefileisreadinbythe<codeclass="language-plaintexthighlighter-rouge">sort</code>commandandthedataismanipulatedasitisprocessedbyeachstageofthecommandpipeline.Because<codeclass="language-plaintexthighlighter-rouge">sort</code>and<codeclass="language-plaintexthighlighter-rouge">cat</code>arehappytoreaditsinputdatafromstdin,orfromafilegivenasanargument,thefollowingpipelinesallachievethesameresult:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">sort</span><spanclass="nt">-n</span>&lt;primes|<spanclass="nb">uniq</span>|<spanclass="nb">grep</span><spanclass="nt">-v</span>18|more<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cat</span>primes|<spanclass="nb">sort</span><spanclass="nt">-n</span>|<spanclass="nb">uniq</span>|<spanclass="nb">grep</span><spanclass="nt">-v</span>18|more<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cat</span>&lt;primes|<spanclass="nb">sort</span><spanclass="nt">-n</span>|<spanclass="nb">uniq</span>|<spanclass="nb">grep</span><spanclass="nt">-v</span>18|more</code></pre></div></div><p>Whichdoyouthinkwouldbemostefficient?</p><p><strong>Anotherpipeline</strong>:HowdidIcreatethatlistofexistingusernames,forLab0?</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>1/etc/passwd|<spanclass="nb">sort</span><spanclass="o">&gt;</span>usernames.txt</code></pre></div></div><blockquote><p>See<codeclass="language-plaintexthighlighter-rouge">mancut</code>tounderstandwhatthefirstcommanddoes.</p></blockquote><p><strong>Anotherexample</strong>:whatisthemostpopularshell?Tryeachoftheseinturn:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>7/etc/passwd<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>7/etc/passwd|less<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>7/etc/passwd|<spanclass="nb">sort</span><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>7/etc/passwd|<spanclass="nb">sort</span>|<spanclass="nb">uniq</span><spanclass="nt">-c</span><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>7/etc/passwd|<spanclass="nb">sort</span>|<spanclass="nb">uniq</span><spanclass="nt">-c</span>|<spanclass="nb">sort</span><spanclass="nt">-n</span><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cut</span><spanclass="nt">-d</span>:<spanclass="nt">-f</span>7/etc/passwd|<spanclass="nb">sort</span>|<spanclass="nb">uniq</span><spanclass="nt">-c</span>|<spanclass="nb">sort</span><spanclass="nt">-nr</span></code></pre></div></div><h3id="macos-tip">MacOStip:</h3><p>Therearethreegreatcommandsyoushouldknow-theyarenotonLinux,becausetheyinteractwithMacOS:<codeclass="language-plaintexthighlighter-rouge">open</code>,<codeclass="language-plaintexthighlighter-rouge">pbpaste</code>,<codeclass="language-plaintexthighlighter-rouge">pbcopy</code>.</p><p>You’vealreadyseenthe<codeclass="language-plaintexthighlighter-rouge">open</code>command,whichonMacOSattheTerminalcommandline,willopenafileforviewingintherelevantMacOSapplication;forexample,foraphotofileyoumighttype<codeclass="language-plaintexthighlighter-rouge">openphoto.jpg</code>andseePreviewlaunchandopenthatfile;foranhtmlfileyoumighttype<codeclass="language-plaintexthighlighter-rouge">openindex.html</code>andseeSafarilaunchandrenderthatpage.</p><p>Thecommands<codeclass="language-plaintexthighlighter-rouge">pbpaste</code>and<codeclass="language-plaintexthighlighter-rouge">pbcopy</code>areagreatfitintomanypipelines.ThefirstcommandprintstheMacOS‘clipboard’toitsstandardoutput,andthesecondcopiesitsstandardinputintotheMacOSclipboard.Forexample;selectsometextinawindowsomewhere,then<em>cmd-C</em>tocopyittotheclipboard,then</p><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>pbpaste|wc</code></pre></div></div><p>tocountthelines,words,andcharactersintheclipboard.Or,</p><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>ls-l|pbcopy</code></pre></div></div><p>savesthedirectorylistingintheclipboard,whereyoumightpasteitintoPiazzaoranemailmessageorsomedocument.</p><p>I’mnotcertainyoucancombine<codeclass="language-plaintexthighlighter-rouge">pbpaste</code>and<codeclass="language-plaintexthighlighter-rouge">pbcopy</code>onthesamecommandline,however;ifyouwantedto<em>replace</em>theclipboardwithitsnumberoflines,youmighttry</p><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>pbpaste|wc-l|pbcopy</code></pre></div></div><p>butbecarefulmixingthosetwocommands.</p><h2id="standard-input-output-and-error">Standardinput,outputanderror</h2><p>Aswelearnedabove,everyprocess(arunningprogram)hasa<em>standardinput</em>(abbreviatedto<codeclass="language-plaintexthighlighter-rouge">stdin</code>)anda<em>standardoutput</em>(<codeclass="language-plaintexthighlighter-rouge">stdout</code>).Theshellsets<codeclass="language-plaintexthighlighter-rouge">stdin</code>tothekeyboardbydefault,butthecommandlinecantelltheshelltoredirect<codeclass="language-plaintexthighlighter-rouge">stdin</code>using<codeclass="language-plaintexthighlighter-rouge">&lt;</code>orapipe.Theshellsets<codeclass="language-plaintexthighlighter-rouge">stdout</code>tothedisplaybydefault,butthecommandlinecantelltheshelltoredirect<codeclass="language-plaintexthighlighter-rouge">stdout</code>using<codeclass="language-plaintexthighlighter-rouge">&gt;</code>or<codeclass="language-plaintexthighlighter-rouge">&gt;&gt;</code>,ortoapipe.</p><p>Eachprocessalsohasa<em>standarderror</em>(<codeclass="language-plaintexthighlighter-rouge">stderr</code>),whichmostprogramsuseforprintingerrormessages.Theseparationof<codeclass="language-plaintexthighlighter-rouge">stdout</code>and<codeclass="language-plaintexthighlighter-rouge">stderr</code>isimportantwhen<codeclass="language-plaintexthighlighter-rouge">stdin</code>isredirectedtoafileorpipe,becausenormaloutputcanflowintothefileorpipewhileerrormessagesreachtheuseronthescreen.</p><p>Insidetherunningprocessthesethreestreamsarerepresentedwithnumeric<em>filedescriptors</em>:</p><ol><li><codeclass="language-plaintexthighlighter-rouge">stdin</code></li><li><codeclass="language-plaintexthighlighter-rouge">stdout</code></li><li><codeclass="language-plaintexthighlighter-rouge">stderr</code></li></ol><p>Youcantelltheshelltoredirectusingthesenumbers;<codeclass="language-plaintexthighlighter-rouge">&gt;</code>isshorthandfor<codeclass="language-plaintexthighlighter-rouge">1&gt;</code>and<codeclass="language-plaintexthighlighter-rouge">&lt;</code>isshorthandfor<codeclass="language-plaintexthighlighter-rouge">0&lt;</code>.Youcanthusredirectthestandarderror(filedescriptor2)withthesymbol<codeclass="language-plaintexthighlighter-rouge">2&gt;</code>.SupposeIwasloggedinas<codeclass="language-plaintexthighlighter-rouge">dfk</code>andwantedtomakealistofthewebfiles<codeclass="language-plaintexthighlighter-rouge">index.html</code>anywhereinthe<codeclass="language-plaintexthighlighter-rouge">cs50</code>account’shomedirectorytree.</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span>find~cs50<spanclass="nt">-name</span>index.html<spanclass="o">&gt;</span>pagesfind:<spanclass="sb">`</span>/net/class/cs50/Archive/src<spanclass="s1">':Permissiondeniedfind:`/net/class/cs50/.emacs.d'</span>:Permissiondeniedfind:<spanclass="sb">`</span>/net/class/cs50/private/<spanclass="s1">':Permissiondenied[engs50@mc~]$</span></code></pre></div></div><p>Iredirectedtheoutputof<codeclass="language-plaintexthighlighter-rouge">find</code>toafilecalled<codeclass="language-plaintexthighlighter-rouge">pages</code>-andindeedthatfilefilledwithusefulinformation-but<codeclass="language-plaintexthighlighter-rouge">find</code>printeditserrormessagestothescreensoIcouldstillseethem.SupposeIwantedtocapturethoseerrorsinafiletoo:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span>find~cs50<spanclass="nt">-name</span>index.html<spanclass="o">&gt;</span>pages2&gt;errors<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>Thefile<codeclass="language-plaintexthighlighter-rouge">errors</code>containstheerrormessageswesawearlier.</p><p>Asanotheralternative,wecouldignoretheerroroutputentirelybysendingittoaplacewhereallcharactersgoandneverreturn!</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span>find~cs50<spanclass="nt">-name</span>index.html<spanclass="o">&gt;</span>pages2&gt;/dev/null<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>Thefilecalled<codeclass="language-plaintexthighlighter-rouge">/dev/null</code>isaspecialkindoffile-it’snotafileatall,actually,it’sa‘device’thatsimplydiscardsanythingwrittentoit.(Ifyoureadfromit,itappearstobeanemptyfile.)</p><h2id="special-characters">Specialcharacters</h2><p>Thereareanumberofspecialcharactersinterpretedbytheshell-spaces,tabs,wildcard(‘globbing’)charactersforfilenameexpansion,redirectionsymbols,andsoforth.Specialcharactershavespecialmeaningandcannotbeusedasregularcharactersbecausetheshellinterpretstheminaspecialmanner.Thesespecialcharactersinclude:</p><p><codeclass="language-plaintexthighlighter-rouge">&amp;;|*?`"'[]()$&lt;&gt;{}#/\!~</code></p><p>Wehavealreadyusedseveralofthesespecialcharacters.Don’ttrytomemorizethematthisstage.Throughuse,theywillbecomesecondnature.Wewilljustgivesomeexamplesoftheoneswehavenotdiscussedsofar.</p><h2id="quoting">Quoting</h2><p>Ifyouneedtouseoneofthesespecialcharactersasaregularcharacter,youcantelltheshellnottointerpretitbyescapingorquotingit.To<em>escape</em>asinglespecialcharacter,precedeitwithabackslash<codeclass="language-plaintexthighlighter-rouge">\</code>;earlierwesawhowtoescapethecharacter<codeclass="language-plaintexthighlighter-rouge">*</code>with<codeclass="language-plaintexthighlighter-rouge">\*</code>.Toescapemultiplespecialcharacters(asin<codeclass="language-plaintexthighlighter-rouge">**</code>),quoteeach:<codeclass="language-plaintexthighlighter-rouge">\*\*</code>.Youcanalso<em>quote</em>usingsinglequotationmarkssuchas<codeclass="language-plaintexthighlighter-rouge">'**'</code>ordoublequotationmarkssuchas<codeclass="language-plaintexthighlighter-rouge">"**"</code>-butthesehavesubtletydifferentbehavior.Youmightusethisformwhenquotingafilenamewithembeddedspaces:<codeclass="language-plaintexthighlighter-rouge">"Homeworkassignment"</code>.</p><p>Youwilloftenneedtopassspecialcharactersaspartofargumentstocommandsandotherprograms-forexample,anargumentthatrepresentsapatterntobeinterpretedbythecommand;ashappensoftenwith<codeclass="language-plaintexthighlighter-rouge">find</code>and<codeclass="language-plaintexthighlighter-rouge">grep</code>.</p><p>Thereisasituationwheresinglequotesworkdifferentlythandoublequotes.Ifyouuseapairofsinglequotesaroundashellvariablesubstitution(like<codeclass="language-plaintexthighlighter-rouge">$USER</code>),thevariable’svaluewillnotbesubstituted,whereasitwouldbesubstitutedwithindoublequotes:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">echo</span><spanclass="s2">"</span><spanclass="nv">$LOGNAME</span><spanclass="s2">usesthe</span><spanclass="nv">$SHELL</span><spanclass="s2">shellandhishomedirectoryis</span><spanclass="nv">$HOME</span><spanclass="s2">."</span>cs50usesthe/bin/bashshellandhishomedirectoryis/net/class/cs50.<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">echo</span><spanclass="s1">'$LOGNAMEusesthe$SHELLshellandhishomedirectoryis$HOME.'</span><spanclass="nv">$LOGNAME</span>usesthe<spanclass="nv">$SHELL</span>shellandhishomedirectoryis<spanclass="nv">$HOME</span><spanclass="nb">.</span><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p><strong><em>Example1.</em></strong>Double-quotesareespeciallyimportantinshellscripts,becausethevariablesinvolvedmighthavebeenuserinput(acommand-lineargumentorakeyboardinput)ormighthavebeafilenameoroutputofacommand;suchvariablesshould<em>always</em>bequotedwhensubstituted,becausespaces(andotherspecialcharacters)embeddedinthevalueofthevariablecancauseconfusion.Thus:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nv">directoryName</span><spanclass="o">=</span><spanclass="s2">"Homeworkthree"</span>...<spanclass="nb">mkdir</span><spanclass="s2">"</span><spanclass="nv">$directoryName</span><spanclass="s2">"</span><spanclass="nb">mkdir</span><spanclass="nv">$directoryName</span></code></pre></div></div><p>Tryit!</p><p><strong><em>Example2.</em></strong>Escapesandquotingcanpassspecialcharactersandpatternspassedtocommands.</p><p>SupposeIhavealistofemailaddresses,oneperline.</p><divclass="language-plaintexthighlighter-rouge"><divclass="highlight"><preclass="highlight"><code>EricChen&lt;eric.t.chen.17@dartmouth.edu&gt;RuiLiu&lt;Rui.Liu.GR@dartmouth.edu&gt;TaylorHardin&lt;Taylor.A.Hardin.GR@dartmouth.edu&gt;ElenaN.Horton&lt;Elena.N.Horton.18@dartmouth.edu&gt;JinnanGe&lt;Jinnan.Ge.TH@dartmouth.edu&gt;MauricioEsquivelRogel&lt;Mauricio.Esquivel.Rogel.18@dartmouth.edu&gt;JamesEdwards&lt;James.G.Edwards.18@dartmouth.edu&gt;EmilyJ.Lin&lt;Emily.J.Lin.18@dartmouth.edu&gt;JohnCardwell&lt;John.R.Cardwell.18@dartmouth.edu&gt;JohnKotz&lt;John.P.Kotz.19@dartmouth.edu&gt;JoelJ.Katticaran&lt;joel.j.katticaran.ug@dartmouth.edu&gt;KayaM.Thomas&lt;Kaya.M.Thomas.17@dartmouth.edu&gt;TrevorL.Davis&lt;trevor.l.davis.18@dartmouth.edu&gt;ThomasD.Kim&lt;Thomas.D.Kim.19@dartmouth.edu&gt;KyleDotterrer&lt;kyle.dotterrer.18@dartmouth.edu&gt;</code></pre></div></div><p>Someemailprograms,orwebsites,requirethesetobecomma-separated.IfIhavetheabovetextinmyclipboard,Icanchangethosenewlinecharacterstocommas:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nv">$</span>pbpaste|<spanclass="nb">tr</span><spanclass="se">\\</span>n,EricChen&lt;eric.t.chen.17@dartmouth.edu&gt;,RuiLiu&lt;Rui.Liu.GR@dartmouth.edu&gt;,TaylorHardin&lt;Taylor.A.Hardin.GR@dartmouth.edu&gt;,ElenaN.Horton&lt;Elena.N.Horton.18@dartmouth.edu&gt;,JinnanGe&lt;Jinnan.Ge.TH@dartmouth.edu&gt;,MauricioEsquivelRogel&lt;Mauricio.Esquivel.Rogel.18@dartmouth.edu&gt;,JamesEdwards&lt;James.G.Edwards.18@dartmouth.edu&gt;,EmilyJ.Lin&lt;Emily.J.Lin.18@dartmouth.edu&gt;,JohnCardwell&lt;John.R.Cardwell.18@dartmouth.edu&gt;,JohnKotz&lt;John.P.Kotz.19@dartmouth.edu&gt;,JoelJ.Katticaran&lt;joel.j.katticaran.ug@dartmouth.edu&gt;,KayaM.Thomas&lt;Kaya.M.Thomas.17@dartmouth.edu&gt;,TrevorL.Davis&lt;trevor.l.davis.18@dartmouth.edu&gt;,ThomasD.Kim&lt;Thomas.D.Kim.19@dartmouth.edu&gt;,KyleDotterrer&lt;kyle.dotterrer.18@dartmouth.edu&gt;</code></pre></div></div><blockquote><p>OnUnixasinglespecialcharactercalled‘newline’iswhat<em>defines</em>theendofonelineandthebeginningofthenext.Acommonsyntaxforthenewlinecharacter,inprogramminglanguages,is<codeclass="language-plaintexthighlighter-rouge">\n</code>.Butthe<codeclass="language-plaintexthighlighter-rouge">\</code>isspecial,inbash,soweneedtoescapeit,um,with<codeclass="language-plaintexthighlighter-rouge">\</code>;thuswehave<codeclass="language-plaintexthighlighter-rouge">\\n</code>.</p></blockquote><p>The<codeclass="language-plaintexthighlighter-rouge">tr</code>commandfilters<codeclass="language-plaintexthighlighter-rouge">stdin</code>to<codeclass="language-plaintexthighlighter-rouge">stdout</code>,translateseachinstanceofthecharactergiveninthefirstargument(<codeclass="language-plaintexthighlighter-rouge">\\n</code>)tothecharactergiveninthesecondargument(<codeclass="language-plaintexthighlighter-rouge">,</code>).Here,<codeclass="language-plaintexthighlighter-rouge">tr</code>spitoutthetranslatedinput-ononeverylonglinethatdoesnotendwithanewline.Icanthencopy-pastethatresultintothepeskywebbrowser.</p><p>OutlookandMicrosofttoolswant<em>semicolons</em>,notcommas;sigh.Butthesemicolonisalsospecialtobash;sowemustescapeittoo:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nv">$</span><spanclass="nb">tr</span><spanclass="se">\\</span>n<spanclass="se">\;</span></code></pre></div></div><p>OnMacOSIcanconnecttheMacOS“Clipboard”tothistoolasfollows:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nv">$</span>pbpaste|<spanclass="nb">tr</span><spanclass="se">\\</span>n<spanclass="se">\;</span>|pbcopy</code></pre></div></div><p>great!copythelistofaddressestotheclipboard,typethatcommandintheshell,andnowtheclipboardcontainsasemicolon-separatedlistofaddresses.</p><p><strong><em>Example3.</em></strong>Anevenmorepowerfulfilteringtool-thestreameditorcalled<codeclass="language-plaintexthighlighter-rouge">sed</code>-allowsyoutotransformoccurrencesofoneormorepatternsintheinputfile(s):</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nb">sed</span>pattern<spanclass="o">[</span>file]...</code></pre></div></div><p>Forexample,</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">cat</span>.forwardDavidKotz&lt;kotz@cs&gt;EricChen&lt;eric.t.chen.17@dartmouth.edu&gt;RuiLiu&lt;Rui.Liu.GR@dartmouth.edu&gt;TaylorHardin&lt;Taylor.A.Hardin.GR@dartmouth.edu&gt;ElenaN.Horton&lt;Elena.N.Horton.18@dartmouth.edu&gt;JinnanGe&lt;Jinnan.Ge.TH@dartmouth.edu&gt;MauricioEsquivelRogel&lt;Mauricio.Esquivel.Rogel.18@dartmouth.edu&gt;JamesEdwards&lt;James.G.Edwards.18@dartmouth.edu&gt;EmilyJ.Lin&lt;Emily.J.Lin.18@dartmouth.edu&gt;JohnCardwell&lt;John.R.Cardwell.18@dartmouth.edu&gt;JohnKotz&lt;John.P.Kotz.19@dartmouth.edu&gt;JoelJ.Katticaran&lt;joel.j.katticaran.ug@dartmouth.edu&gt;KayaM.Thomas&lt;Kaya.M.Thomas.17@dartmouth.edu&gt;TrevorL.Davis&lt;trevor.l.davis.18@dartmouth.edu&gt;ThomasD.Kim&lt;Thomas.D.Kim.19@dartmouth.edu&gt;KyleDotterrer&lt;kyle.dotterrer.18@dartmouth.edu&gt;<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="c">#removemyself,andexcesswhitespace</span><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">sed</span><spanclass="nt">-e</span>/kotz@cs/d<spanclass="nt">-e</span><spanclass="s1">'s/\t//g'</span><spanclass="nt">-e</span><spanclass="s1">'s/*//g'</span>.forwardEricChen&lt;eric.t.chen.17@dartmouth.edu&gt;RuiLiu&lt;Rui.Liu.GR@dartmouth.edu&gt;TaylorHardin&lt;Taylor.A.Hardin.GR@dartmouth.edu&gt;ElenaHorton&lt;Elena.N.Horton.18@dartmouth.edu&gt;JinnanGe&lt;Jinnan.Ge.TH@dartmouth.edu&gt;MauricioEsquivelRogel&lt;Mauricio.Esquivel.Rogel.18@dartmouth.edu&gt;JamesEdwards&lt;James.G.Edwards.18@dartmouth.edu&gt;EmilyLin&lt;Emily.J.Lin.18@dartmouth.edu&gt;JohnCardwell&lt;John.R.Cardwell.18@dartmouth.edu&gt;JohnKotz&lt;John.P.Kotz.19@dartmouth.edu&gt;JoelKatticaran&lt;joel.j.katticaran.ug@dartmouth.edu&gt;KayaThomas&lt;Kaya.M.Thomas.17@dartmouth.edu&gt;TrevorDavis&lt;trevor.l.davis.18@dartmouth.edu&gt;ThomasKim&lt;Thomas.D.Kim.19@dartmouth.edu&gt;KyleDotterrer&lt;kyle.dotterrer.18@dartmouth.edu&gt;<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="c">#removemyself,removenames,makecomma-seplistofaddresses</span><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">sed</span><spanclass="nt">-e</span>/kotz@cs/d<spanclass="nt">-e</span><spanclass="s1">'s/.*&lt;//'</span><spanclass="nt">-e</span><spanclass="s1">'s/&gt;.*/,/'</span>.forwarderic.t.chen.17@dartmouth.edu,Rui.Liu.GR@dartmouth.edu,Taylor.A.Hardin.GR@dartmouth.edu,Elena.N.Horton.18@dartmouth.edu,Jinnan.Ge.TH@dartmouth.edu,Mauricio.Esquivel.Rogel.18@dartmouth.edu,James.G.Edwards.18@dartmouth.edu,Emily.J.Lin.18@dartmouth.edu,John.R.Cardwell.18@dartmouth.edu,John.P.Kotz.19@dartmouth.edu,joel.j.katticaran.ug@dartmouth.edu,Kaya.M.Thomas.17@dartmouth.edu,trevor.l.davis.18@dartmouth.edu,Thomas.D.Kim.19@dartmouth.edu,kyle.dotterrer.18@dartmouth.edu,<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>Theaboveusesthe<codeclass="language-plaintexthighlighter-rouge">-e</code>switchto<codeclass="language-plaintexthighlighter-rouge">sed</code>,whichallowsonetolistmorethanonepatternonthesamecommand.</p><p>Afewquicknotesaboutsed’spatterns:</p><ul><li><codeclass="language-plaintexthighlighter-rouge">d</code>deleteslinesmatchingthepattern</li><li><codeclass="language-plaintexthighlighter-rouge">p</code>printslinesmatchingthepattern(usefulwith<codeclass="language-plaintexthighlighter-rouge">-n</code>)</li><li><codeclass="language-plaintexthighlighter-rouge">s</code>substitutestextformatchestothepattern.</li></ul><p>Patternsareactually<ahref="http://sed.sourceforge.net/sedfaq3.html#s3.1.1">regularexpressions</a>;Iusesomeabove.</p><p><strong><em>Example4.</em></strong></p><p>IsavedalistofstudentsenrolledinCS50inthefile<codeclass="language-plaintexthighlighter-rouge">~cs50/demo/students.txt</code>.Eachlineisoftheform<codeclass="language-plaintexthighlighter-rouge">First.M.Last.18@Dartmouth.edu;</code>.</p><p>Let’ssupposeyoualldecidetomovetoHarvard.</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">sed</span>s/Dartmouth/Harvard/demo/students.txt...<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">sed</span><spanclass="nt">-e</span>s/Dartmouth/Harvard/<spanclass="nt">-e</span><spanclass="s1">'s/\.[0-9][0-9]//'</span><spanclass="nt">-e</span><spanclass="s1">'s/;$//'</span>demo/students.txt...</code></pre></div></div><p>Thesecondformremovesthedotandtwo-digitclassnumber,andthetrailingsemicolon.NoticehowIquotedthosepatternsfromtheshell,andevenescapedthedotfromsed’snormalmeaning(dotmatchesanycharacter)sosedwouldlookforaliteraldotinthatposition.Thedollar<codeclass="language-plaintexthighlighter-rouge">$</code>constrainsthesemicolonmatchtohappenattheendoftheline.</p><p>Here’sanotherfunpipe:countthenumberofstudentsfromeachclass(leveragingtheclassnumbersinemailaddresses):</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">tr</span><spanclass="nt">-c</span><spanclass="nt">-d</span>0-9<spanclass="se">\\</span>n&lt;demo/students.txt|<spanclass="nb">sed</span><spanclass="s1">'s/^$/other/'</span>|<spanclass="nb">sort</span>|<spanclass="nb">uniq</span><spanclass="nt">-c</span>|<spanclass="nb">sort</span><spanclass="nt">-nr</span>271822199175other116<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>See<codeclass="language-plaintexthighlighter-rouge">mansed</code>orthe<ahref="http://sed.sourceforge.net/sedfaq.html">sedFAQ</a>formoreinfo.You’llwanttolearnabitabout<em>regularexpressions</em>,whichareusedtodescribepatternsinsed’scommands;see<ahref="http://sed.sourceforge.net/sedfaq3.html#s3.1.1">sedregexpinfo</a>.</p><h2id="compressing-and-archiving-files">Compressingandarchivingfiles</h2><p>Itisoftenusefultobundleseveralfilesintoacompressed<em>archive</em>file.YoumayhaveencounteredfileslikethisontheInternet-suchas<codeclass="language-plaintexthighlighter-rouge">files.zip</code>,<codeclass="language-plaintexthighlighter-rouge">something.tar</code>,or<codeclass="language-plaintexthighlighter-rouge">somethin-else.tgz</code>.Eachpackstogetherseveralfiles-includingdirectories,creationdates,accesspermissions,aswellasfilecontents-intoonesinglefile.Thisisaconvenientwaytotransferlargecollectionsoffiles.</p><p>OnUnixitismostcommontousethe<codeclass="language-plaintexthighlighter-rouge">tar</code>utility(shortfortapearchive-frombackwhenweusedtapes)tocreateanarchiveofallthefilesanddirectorieslistedintheargumentsandnameittosomethingappropriate.Weoftenask<codeclass="language-plaintexthighlighter-rouge">tar</code>tocompresstheresultingarchivetoo.</p><p>Givenadirectory<codeclass="language-plaintexthighlighter-rouge">stuff</code>,youcancreate(<codeclass="language-plaintexthighlighter-rouge">c</code>)acompressedtararchive(aka,a“tarball”),andthenlist(<codeclass="language-plaintexthighlighter-rouge">t</code>)itscontents.The<codeclass="language-plaintexthighlighter-rouge">f</code>referstoafileandthe<codeclass="language-plaintexthighlighter-rouge">z</code>referstocompression.</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">mkdir</span>stuff<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">echo</span><spanclass="o">&gt;</span>stuff/x<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">tar</span>cfzstuff.tgzstuff98.8%<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">tar</span>tfzstuff.tgzstuff/stuff/x<spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span></code></pre></div></div><p>Thecommandleavestheoriginaldirectoryandfilesintact.Noticethat<codeclass="language-plaintexthighlighter-rouge">tar</code>hasanunconventionalsyntaxforitsswitches-thereisnodash<codeclass="language-plaintexthighlighter-rouge">-</code>beforethem.</p><p>Tounpackthearchive,</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="o">[</span>engs50@mc~]<spanclass="nv">$</span><spanclass="nb">tar</span>xfzstuff.tgz</code></pre></div></div><p>Inshort,<codeclass="language-plaintexthighlighter-rouge">c</code>forcreate,<codeclass="language-plaintexthighlighter-rouge">t</code>fortype(list),<codeclass="language-plaintexthighlighter-rouge">x</code>forextract.The<codeclass="language-plaintexthighlighter-rouge">f</code>impliesthatthenextargumentisthetarballfilename.The<codeclass="language-plaintexthighlighter-rouge">z</code>indicatesthatthetarballshouldbecompressed.Byconvention,atarballfilenameendsin<codeclass="language-plaintexthighlighter-rouge">.tar</code>ifnotcompressed,<codeclass="language-plaintexthighlighter-rouge">.tgz</code>ifcompressed.</p></div></article></div></div><footerclass="site-footer"><divclass="wrapper"><h2class="footer-heading">Engs50(CS50)--DartmouthCollege</h2><p><fontsize=-1>ThisversionofthecourseisbaseduponthosedesignedbyProfessorsPalmer,Kotz,Zhou,Campbell,andBalkcom.Iamdeeplyindebtedtotheseoutstandingeducators.--<ahref="https://engineering.dartmouth.edu/people/faculty/stephen-taylor/">StephenTaylor</a></font></p><p><small>Thispagewaslastupdatedon<strong>2023-01-05</strong>at<strong>11:31</strong>.</small></p></div></footer></body></html>
