https://thayer.github.io/engs50/Labs/Lab4/
2
21618
<!DOCTYPEhtml><html><head><metacharset="utf-8"><metahttp-equiv="X-UA-Compatible"content="IE=edge"><metaname="viewport"content="width=device-width,initial-scale=1"><title>Lab4-Crawler</title><metaname="description"content="InEngs50youwilllearnhowtodesign&buildlarge,reliable,maintainable,andunderstandablesoftwaresystems.IntheprocessyouwilllearntoprograminCwithUnixdevelopmenttools."><linkrel="shortcuticon"href="/engs50/50.png"/><linkrel="stylesheet"href="/engs50/css/main.css"><linkrel="canonical"href="/engs50/Labs/Lab4/"></head><body><headerclass="site-header"><aclass="site-title"href="/engs50/"><imgwidth=48align=centersrc="/engs50/50.png"alt="icon">Engs50(CS50)</a><navclass="site-nav">[<ahref="/engs50/Labs/">Labs</a>][<ahref="/engs50/Notes/">Notes</a>][<ahref="/engs50/Reading/">Reading</a>][<ahref="/engs50/Resources/">Resources</a>][<ahref="/engs50/Examples/">Examples</a>]</nav></header><divclass="page-content"><divclass="wrapper"><articleclass="post"><headerclass="post-header"><h1class="post-title">Lab4-Crawler</h1></header><divclass="post-content"><p><strong>DueFriday,April27,2018,at10pm</strong></p><p>Inthislabyou’llbegintheTinySearchEngine(TSE)bycodingtheCrawleraccordingtothe<ahref="REQUIREMENTS.html">CrawlerRequirementsSpec</a>andthe<ahref="DESIGN.html">CrawlerDesignSpec</a>.</p><ulid="markdown-toc"><li><ahref="#preparation"id="markdown-toc-preparation">Preparation</a></li><li><ahref="#assignment"id="markdown-toc-assignment">Assignment</a></li><li><ahref="#whatsubmit"id="markdown-toc-whatsubmit">Submission-what</a></li><li><ahref="#howsubmit"id="markdown-toc-howsubmit">Submission-how</a><ul><li><ahref="#extensions"id="markdown-toc-extensions">Extensions</a></li></ul></li><li><ahref="#hints-and-tips"id="markdown-toc-hints-and-tips">Hintsandtips</a><ul><li><ahref="#libcs50"id="markdown-toc-libcs50">libcs50</a></li><li><ahref="#markdown"id="markdown-toc-markdown">Markdown</a></li><li><ahref="#testing-crawler"id="markdown-toc-testing-crawler">TestingCrawler</a></li><li><ahref="#use-valgrind-and-gdb"id="markdown-toc-use-valgrind-and-gdb">Usevalgrindandgdb</a></li><li><ahref="#memory-allocation"id="markdown-toc-memory-allocation">Memoryallocation</a></li><li><ahref="#hashtable-of-url"id="markdown-toc-hashtable-of-url">HashtableofURL</a></li><li><ahref="#pseudocode"id="markdown-toc-pseudocode">Pseudocode</a></li><li><ahref="#pagedirectory"id="markdown-toc-pagedirectory">pageDirectory</a></li></ul></li></ul><h2id="preparation">Preparation</h2><ol><li><p><em>Fork</em>acopyofour<ahref="https://gitlab.cs.dartmouth.edu/CS50/tse">TSEstarterkit</a>tomakeanewprojectinyourGitlabaccount;seeinstructionsintheREADMEthere.Ensuretherepois<em>Private</em>.Give“Master”accesstoProfessorPalmer(ccpalmer)andtoheadgraderHaiderSyed(hemayhavetwoidsinGitlab,usetheonewith“@h”).</p></li><li><p><em>Clone</em>thenewprojecttoaGitrepositoryonyourCSUnixaccount;again,seeinstructionsinyourfork’sREADME.</p></li><li><p>Editthe<codeclass="language-plaintexthighlighter-rouge">README.md</code>filetoremovethegitinstructions;asuggestedtemplateisatthebottomofthefile.Includeyourname!</p></li><li><p>Intheterminal,<strong>copy</strong>your<ahref="Lab3/">Lab3</a>sources(just<codeclass="language-plaintexthighlighter-rouge">counters.[ch]set.[ch]hashtable.[ch]</code>)tothe<codeclass="language-plaintexthighlighter-rouge">libcs50</code>subdirectoryinyourbrand-newrepository;try<codeclass="language-plaintexthighlighter-rouge">make</code>inthatdirectorytoensureeverythingworks.</p></li><li><p><codeclass="language-plaintexthighlighter-rouge">gitaddlibcs50/*.[ch];gitcommit-a;gitpush</code>.</p></li><li><p>Visityourrepoon<ahref="gitlab.cs.dartmouth.edu">Gitlab</a>andyoushouldseetheupdatedREADMEandyournewsourcefiles.Double-checkthe<ahref="https://gitlab.cs.dartmouth.edu/help/public_access/public_access">visibility</a>ofyourrepotoensureitis<strong><em>Private</em></strong>.</p></li></ol><h2id="assignment">Assignment</h2><p>Writethe<em>crawler</em>,firstsub-systemoftheTinySearchEngine.Pleasefollowthe<ahref="/engs50/Resources/CodingStyle.html">CS50codingstyleguidelines</a>,the<ahref="REQUIREMENTS.html">CrawlerRequirementsSpec</a>,andthe<ahref="DESIGN.html">CrawlerDesignSpec</a>.</p><ol><li><p>Createasubdirectory<codeclass="language-plaintexthighlighter-rouge">crawler</code>.</p></li><li><p>Inthatdirectory,writeaprogram<codeclass="language-plaintexthighlighter-rouge">crawler</code>thatimplementstheRequirementsSpec,leveragingyourdatastructures.PleasetakespecialcarethatyourcrawlerdoesnotexploreURLsthatarenot‘internal’accordingto<codeclass="language-plaintexthighlighter-rouge">IsInternalURL()</code>.</p></li><li><p>Inthatdirectory,writea<codeclass="language-plaintexthighlighter-rouge">Makefile</code>soyoucanbuildeverythingfromthetop-leveldirectorybysimplytyping<codeclass="language-plaintexthighlighter-rouge">make</code>,andcleanupeverythingbytyping<codeclass="language-plaintexthighlighter-rouge">makeclean</code>.Tobuild<codeclass="language-plaintexthighlighter-rouge">crawler</code>youwillneedtoadd<codeclass="language-plaintexthighlighter-rouge">-lcurl</code>toincludethe<codeclass="language-plaintexthighlighter-rouge">libcurl</code>library.</p></li><li><p>Inthatdirectory,writea<codeclass="language-plaintexthighlighter-rouge">README.md</code>filetoprovideanyspecialinformationabouthowtocompileoruseyourcrawler.Thisfileislikelytobeshort.<em>YoumustuseMarkdown;seebelow.</em></p></li><li><p>Inthatdirectory,writea<codeclass="language-plaintexthighlighter-rouge">IMPLEMENTATION.md</code>filetodescribetheimplementationofyourcrawler.<em>YoumustuseMarkdown;seebelow.</em></p></li><li><p>Adda<codeclass="language-plaintexthighlighter-rouge">TESTING.md</code>fileinthe<codeclass="language-plaintexthighlighter-rouge">crawler</code>directory,tellingthegraderhowyoutestedyourcrawler.(Youmayfindithelpfultowritea<codeclass="language-plaintexthighlighter-rouge">bash</code>scripttoexecuteyourcrawler,and/ora<codeclass="language-plaintexthighlighter-rouge">maketest</code>target.)Read<ahref="#testing-crawler">abouttesting</a>below.</p></li><li><p>Asyoucreatefilesanddirectories,addthemtoyourgitrepository.<strong>Important:</strong>donotaddanycompiledfilestogit.Inshort:yourreposhouldnotcontainanydatafiles,coredumps,orfilesbuiltwith<codeclass="language-plaintexthighlighter-rouge">make</code>andremovedby<codeclass="language-plaintexthighlighter-rouge">makeclean</code>.Commitandpushatleastonceaday.</p></li></ol><h2id="whatsubmit">Submission-what</h2><p>Inthislabyoushalladd/editthesefilesinyourrepo:</p><ul><li><codeclass="language-plaintexthighlighter-rouge">README.md</code>(edited)</li><li><codeclass="language-plaintexthighlighter-rouge">Makefile</code>(possiblyedited)</li><li><codeclass="language-plaintexthighlighter-rouge">crawler/</code><ul><li><codeclass="language-plaintexthighlighter-rouge">Makefile</code></li><li><codeclass="language-plaintexthighlighter-rouge">crawler.c</code></li><li><codeclass="language-plaintexthighlighter-rouge">README.md</code></li><li><codeclass="language-plaintexthighlighter-rouge">IMPLEMENTATION.md</code></li><li><codeclass="language-plaintexthighlighter-rouge">TESTING.md</code></li><li><em>optionalotherfilesrelatedtotesting</em></li></ul></li><li><codeclass="language-plaintexthighlighter-rouge">common/</code><em>ifyoufollowourtip/suggestionbelow</em><ul><li><codeclass="language-plaintexthighlighter-rouge">pagedir.c</code></li><li><codeclass="language-plaintexthighlighter-rouge">pagedir.h</code></li></ul></li><li><codeclass="language-plaintexthighlighter-rouge">libcs50/</code><em>ifyouwishtouseyourLab3solution</em><ul><li><codeclass="language-plaintexthighlighter-rouge">set.c</code></li><li><codeclass="language-plaintexthighlighter-rouge">counters.c</code></li><li><codeclass="language-plaintexthighlighter-rouge">hashtable.c</code></li></ul></li></ul><p><em>YoushallNOTmodifyanyofthecodeweprovidein<codeclass="language-plaintexthighlighter-rouge">libcs50</code></em>.</p><p><em>YoushallNOTincludeanydatafilesproducedbythecrawler,anybinary/objectfilesproducedbythecompiler,backupfiles,coredumpsetc.</em></p><h2id="howsubmit">Submission-how</h2><p>Whenyouarereadyforfinalsubmission,</p><ul><li><strong>Add</strong>allrequiredfilesusinganappropriate<codeclass="language-plaintexthighlighter-rouge">gitadd</code>commandline.</li><li><strong>Commit</strong>allchangesusinganappropriate<codeclass="language-plaintexthighlighter-rouge">gitcommit</code>commandline.</li><li><strong>Tag</strong>:<codeclass="language-plaintexthighlighter-rouge">gittaglab4submit</code></li><li><strong>Push</strong>:<codeclass="language-plaintexthighlighter-rouge">gitpush--tags</code>toensurethetagsarepushedtotheremote.See<ahref="/git/tags.html">moreabouttags</a>.</li></ul><p>UseyourwebbrowsertoviewyourremoteonGitlabandmakesurethereisatag<codeclass="language-plaintexthighlighter-rouge">lab4submit</code>andthefilesassociatedwiththattaggedcommitincludeeverythingwe’llneedtogradeyourlab.</p><p>Wegradetheversiontagged<codeclass="language-plaintexthighlighter-rouge">lab4submit</code>soitissafeforyoutocontinuework(e.g.,soyoucanstartworkonLab5),evenifyoucommitorpush.</p><p>Wewillcloneyourrepoat0h,24h,48h,and72haftertheoriginaldeadline.Wewillstartgradingwhenwefirstseeonewithtag<codeclass="language-plaintexthighlighter-rouge">lab4submit</code>,andjudgeitlateifthattagwasaddedafterthedeadline.Toavoidconfusion,<em>pleaseblitz<codeclass="language-plaintexthighlighter-rouge">cs50ATcs.dartmouth.edu</code>ifyouwantalatesubmissiontobegradedinsteadofyouron-timesubmission.</em></p><p><strong><em>Yourentirecodebasemustcompilewith<codeclass="language-plaintexthighlighter-rouge">make</code>fromthetop-leveldirectoryandproducenocompilerwarnings.</em></strong>Ifwefindthatyourcodewillnotcompile,orhas<strong>segmentationfaults</strong>,wewillsenditbacktoyouassoonaswecanforrepair;recallthe<ahref="/#crashes">gradingpolicy</a>.</p><p>Wewillrunyourcrawleronourownsetoftestdata.</p><p>Wewillrun<codeclass="language-plaintexthighlighter-rouge">valgrind</code>onyourprogramtolookformemoryleaks;youwilllosepointsformemoryleaksormemoryerrors.<strong>Important</strong>:the<codeclass="language-plaintexthighlighter-rouge">libcurl</code>libraryisknowntoleavesome“stillreachable”memory;thesearenotyourfaultandwillnotcountagainstyou.</p><h3id="extensions">Extensions</h3><p>Ifyouwanttoclaimyour24hextension,createafile<codeclass="language-plaintexthighlighter-rouge">EXTENSION</code>atthetop-leveldirectoryofyourrepository.Don’tforgetto<codeclass="language-plaintexthighlighter-rouge">gitpush</code><em>(beforethedeadline!)</em>sowewillseethefile.Forexample,</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nv">$</span><spanclass="nb">touch</span>EXTENSION<spanclass="nv">$</span>gitaddEXTENSION<spanclass="nv">$</span>gitcommit<spanclass="nt">-m</span><spanclass="s2">"extensionrequest"</span><spanclass="nv">$</span>gittaglab4submit<spanclass="c">#addtag,asabove</span><spanclass="nv">$</span>gitpush<spanclass="nt">--tags</span><spanclass="c">#pushtogitlab,includingtags</span></code></pre></div></div><p>UseyourwebbrowsertoviewyourremoteonGitlabandmakesurethereisatag<codeclass="language-plaintexthighlighter-rouge">lab4submit</code>andthatitsfilesinclude<codeclass="language-plaintexthighlighter-rouge">EXTENSION</code>.</p><p>Whenyouarereadytosubmityourcode,remove<codeclass="language-plaintexthighlighter-rouge">EXTENSION</code>asfollows,<em>updateyoursubmissiontag</em>,andpushtoGitlab:</p><divclass="language-bashhighlighter-rouge"><divclass="highlight"><preclass="highlight"><code><spanclass="nv">$</span>git<spanclass="nb">rm</span>EXTENSION<spanclass="nv">$</span>gitcommit<spanclass="nt">-m</span><spanclass="s2">"readyforgrading"</span><spanclass="nv">$</span>gitpush<spanclass="nt">--delete</span>originlab4submit<spanclass="c">#removethetagfromremote</span><spanclass="nv">$</span>gittag<spanclass="nt">-f</span>lab4submit<spanclass="c">#movethelocaltagforwardtothiscommit</span><spanclass="nv">$</span>gitpush<spanclass="nt">--tags</span><spanclass="c">#pushtogitlabremote,includingtags</span></code></pre></div></div><p>UseyourwebbrowsertoviewyourremoteonGitlabandmakesurethereisatag<codeclass="language-plaintexthighlighter-rouge">lab4submit</code>,thatitsfilesdo<em>not</em>include<codeclass="language-plaintexthighlighter-rouge">EXTENSION</code>,anditsfilesincludeeverythingwe’llneedtogradeyourlab.</p><h1id="hints-and-tips">Hintsandtips</h1><h3id="libcs50">libcs50</h3><p>Weprovideseveralmodulesinthe<codeclass="language-plaintexthighlighter-rouge">libcs50</code>directory,whichcompilestoalibrary<codeclass="language-plaintexthighlighter-rouge">libcs50.a</code>youcanlinkwithyourcrawler.<em>Youshouldnotchangeanyofourcode.</em>Youmaydropinyour<codeclass="language-plaintexthighlighter-rouge">set.[ch]</code>,<codeclass="language-plaintexthighlighter-rouge">counters.[ch]</code>,<codeclass="language-plaintexthighlighter-rouge">hashtable.[ch]</code>filesfromLab3.Ifyou’dprefertouseourversionof<em>set</em>,<em>counters</em>,and<em>hashtable</em>,that’stotallyfine;thestarterkitincludesapre-compiledlibraryyoucanuseinstead;see<codeclass="language-plaintexthighlighter-rouge">libcs50/README.md</code>.</p><p>MostofthemodulesinthisdirectoryaredocumentedwithacorrespondingMarkdownfile.</p><h3id="markdown">Markdown</h3><p>Inthisandsubsequentlabs,youmustprovidedocumentationfilesinMarkdownformat,thatis,youshouldsupply<codeclass="language-plaintexthighlighter-rouge">README.md</code>,<codeclass="language-plaintexthighlighter-rouge">IMPLEMENTATION.md</code>,and<codeclass="language-plaintexthighlighter-rouge">TESTING.md</code>.TheMarkdownsyntaxprovidesverysimple(andreadable)markupforheadings,lists,italics,bold,andcodesnippets.(ThiscoursewebsiteiswritteninMarkdown.)See<ahref="/engs50/Resources/#markdown">Markdownresources</a>.</p><h3id="testing-crawler">TestingCrawler</h3><p>Itisyourresponsibilitytotestyourcrawlerandwriteaboutyourapproachin<codeclass="language-plaintexthighlighter-rouge">TESTING.md</code>.Considerfollowingsomeofthetestingplandiscussedin<ahref="/crawler/">Lecture</a>.</p><p>Somesafeseedsyoumighttestinclude</p><ul><li>http://old-www.cs.dartmouth.edu/~cs50/data/tse/letters</li><li>http://old-www.cs.dartmouth.edu/~cs50/index.html</li><li>http://old-www.cs.dartmouth.edu/~cs50/data/tse/wikipedia</li></ul><blockquote><p>Thefirsttwoaregoodatdepths0andhigher,buttheWikipediacaseislikelytooslowtorunpastmaxDepth=2.</p></blockquote><p>YoumaypointyourcrawleratanyotherCSuser’shomepage-butyourseedURLmustbeginwith<codeclass="language-plaintexthighlighter-rouge">http://old-www.cs.dartmouth.edu/</code>.</p><p>Forexample,youmightconstructyourowntestfilesinyourCSUnixaccountinadirectorylike<codeclass="language-plaintexthighlighter-rouge">~/public_html/tse</code>andcrawltheURL<codeclass="language-plaintexthighlighter-rouge">http://old-www.cs.dartmouth.edu/~YOURUSERID/tse</code></p><h3id="use-valgrind-and-gdb">Usevalgrindandgdb</h3><p>In<ahref="/debug/">Lecture</a>welearnedhowtouse<codeclass="language-plaintexthighlighter-rouge">valgrind</code>and<codeclass="language-plaintexthighlighter-rouge">gdb</code>;makeuseofthem.</p><h3id="memory-allocation">Memoryallocation</h3><p>Youmayfindthe<codeclass="language-plaintexthighlighter-rouge">memory.c</code>moduleuseful.Itsuseisoptional,butitisreadytouseaspartoflibrary<codeclass="language-plaintexthighlighter-rouge">libcs50.a</code>.</p><p>InourLab3wetriedtorecovergracefullyfrommemory-allocationfailures.IntheTSEapplicationprograms,we’llbeabitmorelazy:onNULLreturnfrommalloc/callocyoucanprintanerrorandexitwithnon-zeroexitstatus.(Youmayfindthe<codeclass="language-plaintexthighlighter-rouge">assertp()</code>function,definedbythe<codeclass="language-plaintexthighlighter-rouge">memory</code>module,tobeusefulhere.)</p><h3id="hashtable-of-url">HashtableofURL</h3><p>OurdesigncallsforuseofaHashtabletostoretheURLsalreadyseen.OurHashtableimplementationstoresa<codeclass="language-plaintexthighlighter-rouge">void*item</code>witheachkey…butifyou’rejuststoringURLs(askeys),whatitemdoyoustore?OurhashtabledisallowsNULLitems.Suggestion:justpassaconstantstringastheitem.</p><h3id="pseudocode">Pseudocode</h3><p>Yourimplementationdoesnotneedtofollowourpseudocode;thisisonereasonwhyyouneedtowriteaboutyourimplementationchoicesin<codeclass="language-plaintexthighlighter-rouge">IMPLEMENTATION.md</code>.</p><p>Ourpseudocodereferstoa<codeclass="language-plaintexthighlighter-rouge">pagefetcher</code>;notethisiseffectively<codeclass="language-plaintexthighlighter-rouge">webage_fetch()</code>.<strong>Notethat<codeclass="language-plaintexthighlighter-rouge">webage_fetch()</code>insertsa1-seconddelayaftereveryfetchattempt</strong>;yourCrawlerthusgetsthisbehaviorforfree.</p><p>Ourpseudocodereferstoa<codeclass="language-plaintexthighlighter-rouge">pagescanner</code>;yoursshouldleverage<codeclass="language-plaintexthighlighter-rouge">webage_getNextURL()</code>.</p><h3id="pagedirectory">pageDirectory</h3><p>TheCrawlerissupposedtodeterminewhetherthepathnameprovidedaspageDirectoryisindeedadirectory,andiswritable(meaning,youcancreatefilesthere).How?Thesimplestmethodistocreateafilethere.Ifyouconstructastring<codeclass="language-plaintexthighlighter-rouge">filename</code>thatisthedirectoryname,followedbyaslash<codeclass="language-plaintexthighlighter-rouge">'/'</code>,followedbyafilenamelike<codeclass="language-plaintexthighlighter-rouge">.crawler</code>,youcouldcall<codeclass="language-plaintexthighlighter-rouge">fopen(filename,"w")</code>;ifitreturnsNULL(failure),theneitherthedirectorydoesnotexistorisnotwritable.Ifitreturnsnon-NULL(success),closethefile.It’sfinetoleave<codeclass="language-plaintexthighlighter-rouge">.crawler</code>inthepagedirectory.(Actually,thepresenceofthisfilewilllaterhelpyourindexerconfirmthepageDirectoryisindeedaCrawler-produceddirectory.)</p><p><strong>Tip:thinkahead</strong>,andputthecodeforwritingwebpagestothepageDirectoryinaseparate<codeclass="language-plaintexthighlighter-rouge">pagedir</code>module,inthe<codeclass="language-plaintexthighlighter-rouge">common</code>directory.Writea<codeclass="language-plaintexthighlighter-rouge">Makefile</code>thatproduceslibrary<codeclass="language-plaintexthighlighter-rouge">common/common.a</code>.NotrequiredforLab4butyou’llendupneedingtotakethisstepinLab5anyway.</p></div></article></div></div><footerclass="site-footer"><divclass="wrapper"><h2class="footer-heading">Engs50(CS50)--DartmouthCollege</h2><p><fontsize=-1>ThisversionofthecourseisbaseduponthosedesignedbyProfessorsPalmer,Kotz,Zhou,Campbell,andBalkcom.Iamdeeplyindebtedtotheseoutstandingeducators.--<ahref="https://engineering.dartmouth.edu/people/faculty/stephen-taylor/">StephenTaylor</a></font></p><p><small>Thispagewaslastupdatedon<strong>2023-01-05</strong>at<strong>11:31</strong>.</small></p></div></footer></body></html>
